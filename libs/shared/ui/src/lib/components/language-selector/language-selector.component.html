<div class="relative" #dropdown>
  <button
    (click)="toggleDropdown()"
    class="p-2.5 rounded-xl bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-all border border-slate-200 dark:border-slate-700 shadow-sm flex items-center gap-2"
    [attr.aria-label]="'Select Language'"
  >
    <span class="text-lg">{{ currentLanguageOption().flag }}</span>
    <span class="text-sm font-medium hidden md:inline">{{ currentLanguageOption().code.toUpperCase() }}</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform" [class.rotate-180]="isOpen()" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg>
  </button>

  @if (isOpen()) {
    <div class="absolute top-full mt-2 right-0 w-56 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 py-2 z-50 animate-in fade-in slide-in-from-top-2 duration-200">
      @for (lang of supportedLanguages(); track lang.code) {
        <button
          (click)="selectLanguage(lang.code)"
          class="w-full px-4 py-2.5 flex items-center gap-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors text-left"
          [class.bg-indigo-50]="lang.code === currentLanguage()"
          [class.dark:bg-indigo-900/20]="lang.code === currentLanguage()"
        >
          <span class="text-2xl">{{ lang.flag }}</span>
          <div class="flex-1">
            <p class="font-medium text-slate-900 dark:text-white text-sm">{{ lang.nativeName }}</p>
            <p class="text-xs text-slate-500 dark:text-slate-400">{{ lang.name }}</p>
          </div>
          @if (lang.code === currentLanguage()) {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          }
        </button>
      }
    </div>
  }
</div>

